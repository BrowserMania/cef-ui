
# ğŸš€ **TODO - CEF + WebRTC en Rust** 
> **Une app Rust avec CEF qui sâ€™exÃ©cute dans un conteneur sandboxÃ© et streame son rendu audio/vidÃ©o via WebRTC dans un navigateur distant.**

---

## âœ… **To-Do List Totale**

---

### ğŸ”§ **1. PrÃ©parer ton environnement local**

- [x] Installer Rust (`rustup`, `cargo`)
- [x] Installer `ffmpeg`, `pulseaudio`, `xvfb`, `xauth` pour les tests locaux
- [x] Cloner le repo `cef-ui` et compiler lâ€™exemple
    ```bash
    cargo cef-build-release
    cp ./target/release/cef-ui-simple ./cef-client
    ```

---

### ğŸ› ï¸ **2. CrÃ©er le conteneur Docker**

- [x] CrÃ©er un `Dockerfile` incluant :
  - X11 virtuel (`xvfb`, `xauth`)
  - Audio (`pulseaudio`)
  - VidÃ©o (`ffmpeg`)
  - App Rust (`cef-client`) coder dans un autre depot 
- [x] Ã‰crire le script `start.sh` qui :
  - DÃ©marre PulseAudio
  - Lance `cef-client` via `xvfb-run`
  - Lance `ffmpeg` pour capturer et envoyer en RTP

---

### ğŸ“¡ **3. IntÃ©grer le WebRTC en Rust avec [`webrtc.rs`](https://github.com/webrtc-rs/webrtc)**

- [ ] Ajouter `webrtc = "0.8"` dans `Cargo.toml`
- [x ] CrÃ©er une app Rust qui :
  - CrÃ©e une `PeerConnection`
  - Lit un flux RTP (de `ffmpeg`)
  - Envoie lâ€™offre SDP vers le navigateur
  - ReÃ§oit une `answer` du navigateur

---

### ğŸ§¬ **4. CrÃ©er un canal de signalisation Web (WebSocket ou HTTP)**

- [x] IntÃ©grer un petit serveur HTTP avec `axum`, `warp` ou `hyper`
- [ ] Exposer :
  - `/offer` â†’ retourne lâ€™offre SDP
  - `/answer` â†’ reÃ§oit lâ€™`answer` depuis la page web
- [x] GÃ©rer les `ICE candidates` (optionnel pour MVP)

---

### ğŸŒ **5. CrÃ©er ta page web pour recevoir le flux**

- [ ] Ã‰crire une page HTML avec :
  - `<video autoplay playsinline>`
  - JS pour rÃ©cupÃ©rer lâ€™offre SDP (`fetch /offer`)
  - JS pour envoyer lâ€™`answer` (`POST /answer`)
- [ ] Tester que le flux apparaÃ®t

---

### ğŸ§ª **6. Lier tout Ã§a dans un conteneur unifiÃ©**

- [x] Copier `cef-client`, le serveur WebRTC, la page HTML, le `start.sh` dans le conteneur
- [ ] DÃ©marrer tout automatiquement dans le `CMD`
- [x] Construire lâ€™image :
    ```bash
    docker build -t cef-webrtc .
    ```
- [ ] Lancer le conteneur :
    ```bash
    docker run --rm cef-webrtc
    ```

---

### ğŸ§· **7. SÃ©curiser et finaliser**

- [ ] S'assurer que le conteneur ne **n'expose aucun port** sauf pour la signalisation (ou tout en sortant)
- [ ] Ajouter `--cap-drop`, `--no-new-privileges`, etc.
- [ ] Documenter la procÃ©dure complÃ¨te

---

### ğŸ§­ **Bonus (optionnel)**

- [ ] Ajouter un **reverse proxy NGINX** avec HTTPS pour la signalisation
- [x] Ajouter **STUN/TURN** pour NAT traversal
- [ ] Ajouter un **auth system** si usage en production